{"version":3,"file":"validate-config-and-manifest.js","sources":["../src/core/validate-config-and-manifest.ts"],"sourcesContent":["import * as fs from \"node:fs\";\nimport * as path from \"node:path\";\nimport * as core from \"@actions/core\";\n\n/**\n * Validates that both the manifest file and config file (if provided) exist and are valid JSON\n */\nexport async function validateConfigAndManifest(): Promise<void> {\n  try {\n    const config = process.env.INPUT_CONFIG;\n    const manifestFile = \"./app.manifest.json\";\n    const cwd = process.cwd();\n\n    // Validate manifest exists\n    if (!fs.existsSync(manifestFile)) {\n      throw new Error(`Manifest file not found: ${path.join(cwd, manifestFile)}`);\n    }\n\n    // Validate manifest is valid JSON\n    try {\n      const manifestContent = fs.readFileSync(manifestFile, \"utf-8\");\n      JSON.parse(manifestContent);\n      core.info(`✓ Manifest file is valid JSON: ${manifestFile}`);\n    } catch (error) {\n      throw new Error(\n        `Manifest file is not valid JSON: ${error instanceof Error ? error.message : String(error)}`,\n      );\n    }\n\n    // Validate config file if provided\n    if (config) {\n      if (!fs.existsSync(config)) {\n        throw new Error(`Config file not found: ${path.join(cwd, config)}`);\n      }\n\n      // Validate config is valid JSON\n      try {\n        const configContent = fs.readFileSync(config, \"utf-8\");\n        JSON.parse(configContent);\n        core.info(`✓ Config file is valid JSON: ${config}`);\n      } catch (error) {\n        throw new Error(\n          `Config file is not valid JSON: ${error instanceof Error ? error.message : String(error)}`,\n        );\n      }\n    } else {\n      core.info(\"No config file provided (optional)\");\n    }\n\n    core.info(\"✓ All file validations passed\");\n  } catch (error) {\n    core.setFailed(error instanceof Error ? error.message : String(error));\n    process.exit(1);\n  }\n}\n\nvalidateConfigAndManifest();\n"],"names":["core.info","core.setFailed"],"mappings":";;;AAOA,eAAsB,4BAA2C;AAC/D,MAAI;AACF,UAAM,SAAS,QAAQ,IAAI;AAC3B,UAAM,eAAe;AACrB,UAAM,MAAM,QAAQ,IAAA;AAGpB,QAAI,CAAC,GAAG,WAAW,YAAY,GAAG;AAChC,YAAM,IAAI,MAAM,4BAA4B,KAAK,KAAK,KAAK,YAAY,CAAC,EAAE;AAAA,IAC5E;AAGA,QAAI;AACF,YAAM,kBAAkB,GAAG,aAAa,cAAc,OAAO;AAC7D,WAAK,MAAM,eAAe;AAC1BA,kBAAAA,KAAU,kCAAkC,YAAY,EAAE;AAAA,IAC5D,SAAS,OAAO;AACd,YAAM,IAAI;AAAA,QACR,oCAAoC,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,MAAA;AAAA,IAE9F;AAGA,QAAI,QAAQ;AACV,UAAI,CAAC,GAAG,WAAW,MAAM,GAAG;AAC1B,cAAM,IAAI,MAAM,0BAA0B,KAAK,KAAK,KAAK,MAAM,CAAC,EAAE;AAAA,MACpE;AAGA,UAAI;AACF,cAAM,gBAAgB,GAAG,aAAa,QAAQ,OAAO;AACrD,aAAK,MAAM,aAAa;AACxBA,oBAAAA,KAAU,gCAAgC,MAAM,EAAE;AAAA,MACpD,SAAS,OAAO;AACd,cAAM,IAAI;AAAA,UACR,kCAAkC,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QAAA;AAAA,MAE5F;AAAA,IACF,OAAO;AACLA,kBAAAA,KAAU,oCAAoC;AAAA,IAChD;AAEAA,gBAAAA,KAAU,+BAA+B;AAAA,EAC3C,SAAS,OAAO;AACdC,gBAAAA,UAAe,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AACrE,YAAQ,KAAK,CAAC;AAAA,EAChB;AACF;AAEA,0BAAA;"}