{"version":3,"file":"validate-artifact.js","sources":["../src/core/validate-artifact.ts"],"sourcesContent":["/**\n * validate-artifact.ts\n *\n * Validates the artifact input for the GitHub Action\n *\n * This module handles validation of the artifact file provided by the user, ensuring:\n * - The artifact file path is provided and not empty\n * - The artifact file exists on the filesystem\n * - The artifact is a .zip file (currently the only supported format)\n *\n * Used as part of GitHub Action workflows to ensure the correct artifact file is provided\n * before attempting to publish the application.\n */\n\nimport * as fs from \"node:fs\";\nimport * as path from \"node:path\";\nimport * as core from \"@actions/core\";\n\n/**\n * Validates the artifact file input for the GitHub Action\n *\n * Performs the following checks:\n * 1. Artifact input is provided (required field)\n * 2. File exists at the specified path\n * 3. File has a .zip extension (only supported format)\n *\n * Sets GitHub Action outputs:\n * - `artifact-path`: The resolved absolute path to the validated artifact (on success)\n *\n * Fails the GitHub Action with an error message if validation fails\n *\n * @throws Does not throw, but calls core.setFailed() on validation errors\n * @example\n * // In GitHub Action workflow\n * validateArtifact(); // Validates artifact input and sets output for next step\n */\nexport function validateArtifact(): void {\n  // Get the artifact input from GitHub Action inputs\n  const artifact = core.getInput(\"artifact\");\n\n  // Validate that the artifact input is provided\n  if (!artifact) {\n    core.setFailed(\"Input 'artifact' is required.\");\n    return;\n  }\n\n  // Validate that the artifact file exists\n  const artifactPath = path.resolve(artifact);\n  if (!fs.existsSync(artifactPath)) {\n    core.setFailed(`Artifact file does not exist at path: ${artifactPath}`);\n    return;\n  }\n\n  // Validate that the artifact is a .zip file (only zip format supported for now)\n  const validExtensions = [\".zip\"];\n  const artifactExtension = path.extname(artifactPath).toLowerCase();\n  if (!validExtensions.includes(artifactExtension)) {\n    core.setFailed(\n      `Artifact file must be one of the following types: ${validExtensions.join(\", \")}`,\n    );\n    return;\n  }\n\n  // If all validations pass\n  core.info(\"Artifact validation passed.\");\n\n  // Set the artifact path as an output for use in subsequent steps\n  core.setOutput(\"artifact-path\", artifactPath);\n}\n\n// Execute if called directly\nif (require.main === module) {\n  validateArtifact();\n}\n"],"names":["core.getInput","core.setFailed","core.info","core.setOutput"],"mappings":";;;AAoCO,SAAS,mBAAyB;AAEvC,QAAM,WAAWA,YAAAA,SAAc,UAAU;AAGzC,MAAI,CAAC,UAAU;AACbC,gBAAAA,UAAe,+BAA+B;AAC9C;AAAA,EACF;AAGA,QAAM,eAAe,KAAK,QAAQ,QAAQ;AAC1C,MAAI,CAAC,GAAG,WAAW,YAAY,GAAG;AAChCA,gBAAAA,UAAe,yCAAyC,YAAY,EAAE;AACtE;AAAA,EACF;AAGA,QAAM,kBAAkB,CAAC,MAAM;AAC/B,QAAM,oBAAoB,KAAK,QAAQ,YAAY,EAAE,YAAA;AACrD,MAAI,CAAC,gBAAgB,SAAS,iBAAiB,GAAG;AAChDA,gBAAAA;AAAAA,MACE,qDAAqD,gBAAgB,KAAK,IAAI,CAAC;AAAA,IAAA;AAEjF;AAAA,EACF;AAGAC,cAAAA,KAAU,6BAA6B;AAGvCC,cAAAA,UAAe,iBAAiB,YAAY;AAC9C;AAGA,IAAI,QAAQ,SAAS,QAAQ;AAC3B,mBAAA;AACF;"}